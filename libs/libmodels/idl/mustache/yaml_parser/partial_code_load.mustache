// Copyright (c) 2026 midnightBITS
// This code is licensed under MIT license (see LICENSE for details)

// THIS FILE IS AUTOGENERATED. DO NOT MODIFY

#include <quick_dra/models/project_reader.hpp>
#include <quick_dra/models/count_loaded.hpp>
#include <span>

namespace quick_dra::v{{version}}::partial {
{{# interfaces}}
	bool {{name}}::read(ref_ctx const& ref) {
{{#inheritance}}
		if (!{{{.}}}::read(ref)) return false;

{{/inheritance}}
{{# attributes}}
		if (!read_key(ref, "{{> yaml_name}}", {{name}})) return ref.error("while reading `{{> yaml_name}}`");
{{/ attributes}}

{{#ext_attrs.postprocess}}
		if (!postprocess()) {
			return false;
		}

{{/ext_attrs.postprocess}}
		return true;
	}

	void {{name}}::prepare_for_write() {
{{#ext_attrs.postprocess}}
		preprocess();

{{/ext_attrs.postprocess}}
{{#inheritance}}
		{{{.}}}::prepare_for_write();
{{/inheritance}}
{{# attributes}}
		prepare_child({{name}});
{{/ attributes}}
	}

	void {{name}}::write(ryml::NodeRef& ref) const {
{{#inheritance}}
		{{{.}}}::write(ref);
{{/inheritance}}
{{# attributes}}
		write_key(ref, "{{> yaml_name}}", {{name}});
{{/ attributes}}
	}

	std::pair<int, int> {{name}}::count_loaded() noexcept {
		return sum_loaded(
{{#inheritance}}
			{{{.}}}::count_loaded(),
{{/inheritance}}
{{#attributes}}
			check_if_loaded<{{#type}}{{> pkg-cxx:type}}{{/type}}>({{name}}),
{{/attributes}}
			std::pair{0, 0}
		);
	}

{{/ interfaces}}
} // namespace quick_dra::v{{version}}
