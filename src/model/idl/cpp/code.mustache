// Copyright (c) 2026 midnightBITS
// This code is licensed under MIT license (see LICENSE for details)

// THIS FILE IS AUTOGENERATED. DO NOT MODIFY

#include {{header}}
#include <span>
#include "model/_parser_types.hpp"

namespace quick_dra::v{{version}} {
{{# enums}}
	auto enums({{name}}) {
		static constexpr enum_tag<{{name}}> items[] = {
#define X_NAME(NAME, TOKEN) { TOKEN ## sv, {{name}}::NAME },
			{{NAME}}_X(X_NAME)
#undef X_NAME
		};

		return std::span{items};
	}

{{/ enums}}
{{# interfaces}}
{{^ ext_attrs.no_yaml}}
{{? ext_attrs.ctx}}
	bool read_{{?ext_attrs.external}}local_{{/ext_attrs.external}}value(ref_ctx const& parent, {{name}}& ctx) {
		auto ref = parent;
		ref.{{ext_attrs.ctx}} = &ctx;

{{/ ext_attrs.ctx}}
{{^ ext_attrs.ctx}}
	bool read_{{?ext_attrs.external}}local_{{/ext_attrs.external}}value(ref_ctx const& ref, {{name}}& ctx) {
{{/ ext_attrs.ctx}}
{{# attributes}}
{{^ for_variant}}
{{# attributes.ext_attrs}}
{{# before}}
		{{before}};
{{/ before}}
{{^ attributes.ext_attrs.no_yaml}}
{{^ yaml_name}}
		if (!read_key(ref, "{{key}}", ctx.{{name}}{{?ext_attrs.opt}}, true{{/ext_attrs.opt}})) return ref.error("while reading `{{key}}`");
{{/ yaml_name}}
{{# yaml_name}}
		if (!read_key(ref, "{{yaml_name}}", ctx.{{name}}{{?ext_attrs.opt}}, true{{/ext_attrs.opt}})) return ref.error("while reading `{{yaml_name}}`");
{{/ yaml_name}}
{{/ attributes.ext_attrs.no_yaml}}
{{# after}}
		{{after}};
{{/ after}}
{{/ attributes.ext_attrs}}
{{/ for_variant}}
{{/ attributes}}
{{# subtypes}}

		if({{expr}}) {
			{{interfaces.name}}::{{name}} value{};

{{# attributes}}
{{# attributes.ext_attrs.before}}
			{{before}};
{{/ attributes.ext_attrs.before}}
{{^ attributes.ext_attrs.no_yaml}}
			if (!read_key(ref, "{{key}}", value.{{name}}{{?ext_attrs.opt}}, true{{/ext_attrs.opt}})) return ref.error("while reading `{{key}}`");
{{/ attributes.ext_attrs.no_yaml}}
{{# attributes.ext_attrs.after}}
			{{after}};
{{/ attributes.ext_attrs.after}}
{{/ attributes}}
			ctx.var = std::move(value);
		}
{{/ subtypes}}

		return true;
	}
{{? ext_attrs.external}}
	bool read_value(ref_ctx const& ref, {{name}}& ctx) {
		return read_local_or_external(ref, ctx);
	}
{{/ ext_attrs.external}}
{{/ ext_attrs.no_yaml}}
{{/ interfaces}}
} // namespace quick_dra::v{{version}}
